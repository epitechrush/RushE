[{"name":"my_tar.php","path":".\/.","contenu":"#!\/usr\/bin\/php \n<?php\n$branche = array();\t\t\t   \/\/Structure des Dossier.\n$Nom_Archive = \"output.mytar\";\/\/Nom de Sortie.\n$jsonArray = array();        \/\/Int\u00e9gration du tableau en json.\nvar_dump($Fichier_Array = $argv);     \/\/Stockage des fichier dans un tableau.\n$erreur = \"\";\t\t\t   \/\/Stockage des erreurs dans une variable sp\u00e9cifique.\nif (empty($Fichier_Array))\n{\n\techo \"Veuillez entrez le nom des fichiers \u00e0 archiver.\\n\";\n\texit;\n}\nelse if (count($Fichier_Array) < 1)\n{\n\techo \"Veuillez ins\u00e9rer au moins un dossier.\\n\";\n}\n$branche = list_files_folders($Fichier_Array);\n$jsonArray = branche_to_json($branche,$jsonArray);\n$Nom_Archive = AddFilesToArchive($Nom_Archive,$jsonArray);\nfunction list_files_folders($Fichier_Array)\n{\n\tglobal $branche; \/\/ Je donne l'acc\u00e8s a ces nouvelles valeur.\n\tforeach ($Fichier_Array as $file) {\n\t\tif(is_dir($file))\n\t\t{\n\t\t\t$branche = scan_folder(\"\/\".$file); \/\/Ajout dans la variable $branche les path avec leur noms\n\t\t}\n\t\telse if (file_exists($file)) \/\/ V\u00e9rification de l'existance des fichiers.\n\t\t{\n\t\t\tarray_push($branche, \".\/\".$file); \/\/Empile un ou plusieur \u00e9l\u00e9ment a la fin du tableau.\n\t\t}\n\t\telse\n\t\t{\n\t\t\techo \"Erreur : $file n'existe pas !\";\n\t\t}\n\n\t}\n\treturn $branche; \/\/ On retourne le tableau avec les path des fichier.\n}\n\nfunction scan_folder($directory) \/\/ Scan du dossier courant.\n{\n\tglobal $branche; \/\/ Acc\u00e8s au nouvelle valeur gr\u00e2ce a global.\n\t$relative = \".\".$directory;\n\tif ($dh = opendir($relative))\n\t{\n\t\twhile(false !== ($file = readdir($dh)))\n\t\t{\n\t\t\tif (($file !== '.') && ($file !== '..'))\n\t\t\t{\n\t\t\t\tarray_push($branche, \".\" . $directory . $file);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscan_folder(($directory.$file.'\/'));\n\t\t\t}\n\t\t}\n\t}\n\treturn $tree;\n}\n\nfunction createArchive($name) \/\/ Pr\u00e9paration \u00e0 la cr\u00e9ation de l'archive.\n{\n\tfopen($name,'a'); \/\/ Ouverture du fichier en ecriture et place le pointeur \u00e0 la fin du fichier.\n\techo  \"Cr\u00e9ation de l'archive : \" . $name . \"\\n\";\n\treturn true;\n}\n\nfunction branche_to_json($branche, $jsonArray) \/\/Cr\u00e9\u00e9 un tableau de style json\n{\n\tforeach ($branche as $file) \/\/Parcours des dossier.\n\t{\n\t\t$tmp = explode('\/',$file);\n\t\t$fileName = end($tmp);\n\t\t$fileContents = file_get_contents($file);\/\/R\u00e9cup\u00e8re le contenu des fichier dans le tableau.\n\t\t$path = array_splice($tmp, 0,-1); \/\/ efface et remplace tous les \u00e9l\u00e9ments du tableau. \n\t\t$path = implode('\/', $path);\n\t\t$jsonArray[] = array('name' => $fileName, 'path' => $path, 'contenu' => $fileContents);\n\t}\n\treturn $jsonArray;\n}\n\nfunction AddFilesToArchive($Nom_Archive,$jsonArray) \/\/Pr\u00e9paration des fichier pour compression.\n{\n\tcreateArchive($Nom_Archive);\n\tforeach ($jsonArray as $file) {\n\t\techo  \"Ajout du fichier : \" .$file['name'] . \"\\n\";\n\t\tfile_put_contents($Nom_Archive, utf8_encode(json_encode($jsonArray)));\n\t}\n\techo \"Fin de l'archivage de vos fichier !\\n\";\n\treturn $Nom_Archive;\n}\n\n\/*function compress($Nom_Archive)\n{\n\t$tmp = file_get_contents($Nom_Archive);\n\t$tmp = \"\";\n\tif(file_put_contents($Nom_Archive, $tmp))\n\t{\n\t\techo \"Compression termin\u00e9e avec succ\u00e8s !\";\n\t\treturn true;\n\t}\n\telse\n\t{\n\t\t$erreur = \"Une erreur s'est produite... Veuillez r\u00e9essayer un peu plus tard\";\n\t\treturn false;\n\t}\n}*\/\n?>"},{"name":"test.php","path":".","contenu":""},{"name":"output.mytar","path":".","contenu":"[{\"name\":\"my_tar.php\",\"path\":\".\\\/.\",\"contenu\":\"#!\\\/usr\\\/bin\\\/php \\n<?php\\n$branche = array();\\t\\t\\t   \\\/\\\/Structure des Dossier.\\n$Nom_Archive = \\\"output.mytar\\\";\\\/\\\/Nom de Sortie.\\n$jsonArray = array();        \\\/\\\/Int\\u00e9gration du tableau en json.\\nvar_dump($Fichier_Array = $argv);     \\\/\\\/Stockage des fichier dans un tableau.\\n$erreur = \\\"\\\";\\t\\t\\t   \\\/\\\/Stockage des erreurs dans une variable sp\\u00e9cifique.\\nif (empty($Fichier_Array))\\n{\\n\\techo \\\"Veuillez entrez le nom des fichiers \\u00e0 archiver.\\\\n\\\";\\n\\texit;\\n}\\nelse if (count($Fichier_Array) < 1)\\n{\\n\\techo \\\"Veuillez ins\\u00e9rer au moins un dossier.\\\\n\\\";\\n}\\n$branche = list_files_folders($Fichier_Array);\\n$jsonArray = branche_to_json($branche,$jsonArray);\\n$Nom_Archive = AddFilesToArchive($Nom_Archive,$jsonArray);\\nfunction list_files_folders($Fichier_Array)\\n{\\n\\tglobal $branche; \\\/\\\/ Je donne l'acc\\u00e8s a ces nouvelles valeur.\\n\\tforeach ($Fichier_Array as $file) {\\n\\t\\tif(is_dir($file))\\n\\t\\t{\\n\\t\\t\\t$branche = scan_folder(\\\"\\\/\\\".$file); \\\/\\\/Ajout dans la variable $branche les path avec leur noms\\n\\t\\t}\\n\\t\\telse if (file_exists($file)) \\\/\\\/ V\\u00e9rification de l'existance des fichiers.\\n\\t\\t{\\n\\t\\t\\tarray_push($branche, \\\".\\\/\\\".$file); \\\/\\\/Empile un ou plusieur \\u00e9l\\u00e9ment a la fin du tableau.\\n\\t\\t}\\n\\t\\telse\\n\\t\\t{\\n\\t\\t\\techo \\\"Erreur : $file n'existe pas !\\\";\\n\\t\\t}\\n\\n\\t}\\n\\treturn $branche; \\\/\\\/ On retourne le tableau avec les path des fichier.\\n}\\n\\nfunction scan_folder($directory) \\\/\\\/ Scan du dossier courant.\\n{\\n\\tglobal $branche; \\\/\\\/ Acc\\u00e8s au nouvelle valeur gr\\u00e2ce a global.\\n\\t$relative = \\\".\\\".$directory;\\n\\tif ($dh = opendir($relative))\\n\\t{\\n\\t\\twhile(false !== ($file = readdir($dh)))\\n\\t\\t{\\n\\t\\t\\tif (($file !== '.') && ($file !== '..'))\\n\\t\\t\\t{\\n\\t\\t\\t\\tarray_push($branche, \\\".\\\" . $directory . $file);\\n\\t\\t\\t}\\n\\t\\t\\telse\\n\\t\\t\\t{\\n\\t\\t\\t\\tscan_folder(($directory.$file.'\\\/'));\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn $tree;\\n}\\n\\nfunction createArchive($name) \\\/\\\/ Pr\\u00e9paration \\u00e0 la cr\\u00e9ation de l'archive.\\n{\\n\\tfopen($name,'a'); \\\/\\\/ Ouverture du fichier en ecriture et place le pointeur \\u00e0 la fin du fichier.\\n\\techo  \\\"Cr\\u00e9ation de l'archive : \\\" . $name . \\\"\\\\n\\\";\\n\\treturn true;\\n}\\n\\nfunction branche_to_json($branche, $jsonArray) \\\/\\\/Cr\\u00e9\\u00e9 un tableau de style json\\n{\\n\\tforeach ($branche as $file) \\\/\\\/Parcours des dossier.\\n\\t{\\n\\t\\t$tmp = explode('\\\/',$file);\\n\\t\\t$fileName = end($tmp);\\n\\t\\t$fileContents = file_get_contents($file);\\\/\\\/R\\u00e9cup\\u00e8re le contenu des fichier dans le tableau.\\n\\t\\t$path = array_splice($tmp, 0,-1); \\\/\\\/ efface et remplace tous les \\u00e9l\\u00e9ments du tableau. \\n\\t\\t$path = implode('\\\/', $path);\\n\\t\\t$jsonArray[] = array('name' => $fileName, 'path' => $path, 'contenu' => $fileContents);\\n\\t}\\n\\treturn $jsonArray;\\n}\\n\\nfunction AddFilesToArchive($Nom_Archive,$jsonArray) \\\/\\\/Pr\\u00e9paration des fichier pour compression.\\n{\\n\\tcreateArchive($Nom_Archive);\\n\\tforeach ($jsonArray as $file) {\\n\\t\\techo  \\\"Ajout du fichier : \\\" .$file['name'] . \\\"\\\\n\\\";\\n\\t\\tfile_put_contents($Nom_Archive, utf8_encode(json_encode($jsonArray)));\\n\\t}\\n\\techo \\\"Fin de l'archivage de vos fichier !\\\\n\\\";\\n\\treturn $Nom_Archive;\\n}\\n\\n\\\/*function compress($Nom_Archive)\\n{\\n\\t$tmp = file_get_contents($Nom_Archive);\\n\\t$tmp = \\\"\\\";\\n\\tif(file_put_contents($Nom_Archive, $tmp))\\n\\t{\\n\\t\\techo \\\"Compression termin\\u00e9e avec succ\\u00e8s !\\\";\\n\\t\\treturn true;\\n\\t}\\n\\telse\\n\\t{\\n\\t\\t$erreur = \\\"Une erreur s'est produite... Veuillez r\\u00e9essayer un peu plus tard\\\";\\n\\t\\treturn false;\\n\\t}\\n}*\\\/\\n?>\"},{\"name\":\"test.php\",\"path\":\".\",\"contenu\":\"\"}]"}]